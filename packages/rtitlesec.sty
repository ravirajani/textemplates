\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{rtitlesec}
\RequirePackage[pagestyles,nobottomtitles]{titlesec}
\RequirePackage{etoolbox}
\RequirePackage{kvoptions}

\SetupKeyvalOptions{
    family=RTS,
    prefix=RTS@
}

\DeclareStringOption[article]{style}

\ProcessKeyvalOptions*

\newcommand{\hdrfont}{\fontsize{9}{11}\selectfont}
\newlength{\parlabelsep}
\setlength{\parlabelsep}{1.5ex plus 1.5ex minus .3ex}

\titleformat{\chapter}[display]
{\normalfont\Large\bfseries\filcenter}{\LARGE\thechapter}{.5ex}{}
\titleformat{\section}
{\normalfont\large\bfseries\filcenter}{\thesection}{1ex}{}
\titleformat{\subsection}
{\normalfont\normalsize\itshape\bfseries\filcenter}{\thesubsection}{1ex}{}
\titleformat{\subsubsection}
{\normalfont\normalsize\itshape\filcenter}{\thesubsubsection}{1ex}{}
\titleformat{\paragraph}[runin]
{\normalfont\normalsize\bfseries}{\theparagraph}{1ex}{}
\titleformat{\subparagraph}[runin]
{\normalfont\normalsize\itshape\bfseries}{\thesubparagraph}{1ex}{}

\titlespacing*{\chapter}{2em}{-10pt}{44pt}[2em]
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{\parlabelsep}
\titlespacing*{\subparagraph}{\parindent}{1.5ex plus .5ex minus .2ex}{\parlabelsep}

\renewpagestyle{plain}{
    \sethead{}{}{}
    \ifdefstring{\RTS@style}{exercises}{
        \setfoot{\hdrfont\copyright\ \the\year\ \@author}{}{}
    }{\setfoot{}{\hdrfont\thepage}{}}
}
\newpagestyle{report}{%
    \sethead{}{\hdrfont\thechapter\enspace\MakeUppercase{\chaptertitle}}{}
    \setfoot{}{\hdrfont\thepage}{}
}
\newpagestyle{report*}{%
    \sethead{}{\hdrfont\MakeUppercase{\chaptertitle}}{}
    \setfoot{}{\hdrfont\thepage}{}
}
\newpagestyle{article}{%
    \sethead{}{\hdrfont\thesection\enspace\MakeUppercase{\sectiontitle}}{}
    \setfoot{}{\hdrfont\thepage}{}
}
\newpagestyle{article*}{%
    \sethead{}{\hdrfont\MakeUppercase{\sectiontitle}}{}
    \setfoot{}{\hdrfont\thepage}{}
}
\newpagestyle{exercises}{%
    \sethead{}{\hdrfont\MakeUppercase{\@title}}{}
    \setfoot{\hdrfont\copyright\ \the\year\ \@author}{}{\hdrfont\thepage}
}
\assignpagestyle{\chapter}{plain}

% Use commands \pagestyle{<pagestyle>} to change all pagestyles from here on in document,
% and \thispagestyle{<pagestyle>} to change the current pagestyle