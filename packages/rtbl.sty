\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{rtbl}

\RequirePackage{tabularray}
\UseTblrLibrary{counter}

\RequirePackage{etoolbox}

\newcounter{slideincell}
\newcounter{offsetcell}
\newcounter{pausesoffset}
\newcommand{\roworcol}{col}

\newenvironment{rtbl}[2]{
    \defcounter{slideincell}{\value{beamerpauses} - #2}
    \defcounter{pausesoffset}{#2 - 1}
    \ifstrequal{#1}{row}{\renewcommand{\roworcol}{row}}{\renewcommand{\roworcol}{col}}
    \begin{tblr}
}{
    \ifdefstring{\roworcol}{col}{
    \addtocounter{beamerpauses}{\value{colcount} - \value{pausesoffset}}
    }{\addtocounter{beamerpauses}{\value{rowcount} - \value{pausesoffset}}}
    \end{tblr}
}

\newcommand{\colonslide}{%
\defcounter{offsetcell}{\value{slideincell} + \value{colnum}}%
\onslide<\arabic{offsetcell}->}

\newcommand{\rowonslide}{%
\defcounter{offsetcell}{\value{slideincell} + \value{rownum}}%
\onslide<\arabic{offsetcell}->}
